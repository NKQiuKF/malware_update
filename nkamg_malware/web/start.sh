#!/bin/bash
#sed -i "s/whereisyournkamg/whereisyournkamg" feature_importance.pickle
PORT="8089"
SHELL_FOLDER=$(dirname $(readlink -f "$0"))
cd $SHELL_FOLDER

export PYTHONPATH=$SHELL_FOLDER
#x=`ps -ef|grep genAsmAndBytes.py|grep -v grep|head -n 1|awk {'print $9'}`
#if [ -z "$x" ];then
#  python genAsmAndBytes.py 
#  echo generate Asm and Bytes
#fi
#python web_wget.py

rm -f ../server/ml/feature/test/* 2>/dev/null
rm -f ../server/ml/feature3/test/* 2>/dev/null
rm -f file/*

cd ../server/ml/feature/
if [ ! -d test ];then
mkdir test  #建立test文件夹
fi
x=`ps -ef|grep ml.py|grep -v grep|head -n 1|awk {'print $9'}`
if [ -z "$x"  ];then
  python ml.py &
  echo start model1
fi

#cd ../feature2/
#if [ ! -d test ];then
#mkdir test
#fi
#y=`ps -ef|grep ml2.py|grep -v grep|head -n 1|awk {'print $9'}`
#if [ -z "$y" ];then
#	python ml2.py &
#	echo start model2
#fi

cd ../feature3/
if [ ! -d test ];then
mkdir test  #建立test文件夹
fi
z=`ps -ef|grep ml3.py|grep -v grep|head -n 1|awk {'print $9'}`
if [ -z "$z" ];then
	cd code
	python ml3.py &
	echo start model3
fi

cd $SHELL_FOLDER
cd ../server/ml/apk/
if [ ! -d work ];then
mkdir work
fi
p=`ps -ef|grep apkmonitor.py|grep -v grep|head -n 1|awk {'print $9'}`
if [ -z "$p" ];then
	cd src
	python apkmonitor.py &
	echo start android model1
fi

cd $SHELL_FOLDER
superset/bin/superset runserver -p ${PORT} 
