#coding:utf-8

import os
import pandas as pd
from superset.data import *

urls = ['192.168.0.161:5000/count161.csv']#,'192.168.0.162:5000/count162.csv',
#'192.168.0.166:5000/count166.csv','192.168.0.167:5000/count167.csv']

for url in urls:
  try:
    os.popen('wget '+url)
  except Exception,e:
    print e
    continue
try:
  count161 = pd.read_csv('count161.csv',sep=',',names=['subclass','count','class'])
  _ = count161[count161['subclass']=='Apk '].index[0]
  print '161 done'
except IndexError,e:
  count161.loc[len(count161)]=['Apk ',2996977,'Android']
  print 'build Apk class'
  
#try:
#  count162 = pd.read_csv('count162.csv')
#  count161.loc[count161[count161['subclass']=='Apk '].index[0],'count'] = count161[count161['subclass']=='Apk ']['count'].values+count162[count162['subclass']=='Apk ']['count'].values
#  print '162 done'
#except Exception,e:
#  print '162',e
#  pass
#
#try:
#  count166 = pd.read_csv('count166.csv')
#  count161.loc[count161[count161['subclass']=='Apk '].index[0],'count']=count161[count161['subclass']=='Apk ']['count'].values+count166[count166['subclass']=='Apk ']['count'].values
#  print '166 done'
#except Exception,e:
#  print '166',e
#  pass

#try:
#  count167 = pd.read_csv('count167.csv')
#  count161.loc[count161[count161['subclass']=='Apk '].index[0],'count']=count161[count161['subclass']=='Apk ']['count'].values+count167[count167['subclass']=='Apk ']['count'].values
#  print '167 done'
#except Exception,e:
#  print '167',e
#  pass
#
count161.to_sql(
	'all_sample',
	db.engine,
	if_exists='replace',
        chunksize=500,
	index=False)
print("-"*80)
print "updated!"
#
#
#urls = ['192.168.0.162:5000/count1621.csv','192.168.0.166:5000/count1661.csv','192.168.0.167:5000/count1671.csv']
#
#for url in urls:
#  try:
#    os.popen('wget '+url)
#  except Exception,e:
#    print e
#    continue
#try:
#  count1621 = pd.read_csv('count1621.csv',sep=',')
#  print '1621 done'
#except IndexError,e:
#  count1621 = pd.DataFrame([['Data',0,'Data']],columns=['subclass','count','class'])
#  print 'build Data class'
  
#try:
#  count1661 = pd.read_csv('count1661.csv')
#  count1621.loc[count1621[count1621['subclass']=='Data'].index[0],'count']=count1621[count1621['subclass']=='Data']['count'].values+count1661[count1661['subclass']=='Data']['count'].values
#  print '1661 done'
#except Exception,e:
#  print '1661',e
#  pass
#
#try:
#  count1671 = pd.read_csv('count1671.csv')
#  count1621.loc[count1621[count1621['subclass']=='Data'].index[0],'count']=count1621[count1621['subclass']=='Data']['count'].values+count1671[count1671['subclass']=='Data']['count'].values
#  print '1671 done'
#except Exception,e:
#  print '1671',e
#  pass

#count1621.to_sql(
#	'Android_data',
#	db.engine,
#	if_exists='replace',
#        chunksize=500,
#	index=False)
#
#print("-"*80)
#os.popen("rm -f count16*")
#obj = db.session.query(TBL).filter_by(table_name='train_data').first()
#if not obj:
#  obj = TBL(table_name="DrebinModel")
#obj.data
  
  
