#!/usr/bin/env python
#-*- coding:utf-8 -*-
import os
import pandas as pd
from core.settings import get_malware_dir
from core.settings import get_benign_dir

STRPATH = '0123456789abcdef'
count_malware = 0
count_benign = 0
count_data_m = 0
count_data_b = 0
count_vt_m = 0
count_vt_b = 0
for i in list(STRPATH):
  for j in list(STRPATH):
    for k in list(STRPATH):
      malware_file = get_malware_dir(i+j+k)
      benign_file = get_benign_dir(i+j+k)
      malwares = os.listdir(malware_file)
      benigns = os.listdir(benign_file)
      count_vt_m = count_vt_m+int(os.popen('cat '+malware_file+'vt_report.csv|wc -l').read()[:-1])
      count_vt_b = count_vt_b+int(os.popen('cat '+benign_file+'vt_report.csv|wc -l').read()[:-1])
      for l in malwares:
        if 'xml' == l[-3:]
          continue
        if 'data' == l[-4:]:
          count_data_m = count_data_m + 1
          continue
        if '.' in l:
          continue
        count_malware = count_malware + 1
      for l in benigns:
        if 'xml' == l[-3:]:
          continue
        if 'data' in l[-4:]:
          count_data_b = count_data_b + 1
          continue
        if '.' in l:
          continue
        count_benign = count_benign + 1

#print str(count_malware) + ' ' + str(count_benign) + ' ' + str(count_data_m) + ' ' + str(count_data_b)
df1 = pd.DataFrame({'subclass': ['Apk '], 'count':[count_malware+count_benign], 'class': ['Android']}, columns=['subclass','count','class'])
df1.to_csv('/data/app/count_apk.csv', index=False, sep=',', columns= ['subclass','count','class'])

df2 = pd.DataFrame({'subclass': ['Data','Benign_Apk','Malware_Apk','Malware_Labeled','Benign_Labeled'], 'count':[count_data_m + count_data_b,count_benign,count_malware,count_vt_m,count_vt_b], 'class': ['Data','benign','malware','vt_number','vt_number']}, columns=['subclass','count','class'])

df2.to_csv('/data/app/count_data.csv', index=False, sep=',', columns= ['subclass','count','class'])

